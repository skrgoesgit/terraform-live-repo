version: 3
projects:
- dir: eu-west-1/dce/vpc/terragrunt.hcl
  workflow: terragrunt
- dir: eu-west-1/dce/services/ocp3/terragrunt.hcl
  workflow: terragrunt
- dir: eu-west-1/dce/services/sc-appsrv/terragrunt.hcl
  workflow: terragrunt
- dir: eu-west-1/ace/vpc/terragrunt.hcl
  workflow: terragrunt
- dir: eu-west-1/ace/rds/ora/sc/terragrunt.hcl
  workflow: terragrunt
- dir: eu-west-1/ace/rds/mssql/xb/terragrunt.hcl
  workflow: terragrunt
- dir: eu-west-1/ace/services/ocp3
  workflow: terragrunt
workflows:
  terragrunt:
    plan:
      steps:
      - env:
          name: TERRAGRUNT_TFPATH
          command: 'echo "terraform${ATLANTIS_TERRAFORM_VERSION}"'
      - run: terragrunt plan -no-color -out $PLANFILE
    apply:
      steps:
      - env:
          name: TERRAGRUNT_TFPATH
          command: 'echo "terraform${ATLANTIS_TERRAFORM_VERSION}"'
      - run: terragrunt apply -no-color $PLANFILE
